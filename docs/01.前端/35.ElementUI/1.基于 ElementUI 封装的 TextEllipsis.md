---
title: åŸºäº ElementUI å°è£…çš„ TextEllipsis
date: 2020-09-03 00:00:00
categories:
  - FrontEnd
tags:
  - Js
  - ElementUI
thumbnail: /img/element-ui/thumbnail.svg
permalink: /pages/e29708/
---

åšé¡¹ç›®ä¸­æ–‡æœ¬æº¢å‡ºæ˜¾ç¤ºçœç•¥å·æ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„åŠŸèƒ½, ä¸€èˆ¬åšæ³•éƒ½æ˜¯å¢åŠ  `css` æ ·å¼å¹¶ä¸”é¼ æ ‡æ‚¬æµ®åæ˜¾ç¤ºå…¨éƒ¨å†…å®¹, ä½†æœ‰æ—¶å€™æ˜æ˜æ²¡æœ‰æº¢å‡º, æ‚¬æµ®ä¹Ÿä¼šæ˜¾ç¤ºå†…å®¹, æ‰€ä»¥æˆ‘ä»¬éœ€è¦åšä¸€ç‚¹å¤„ç†

<!-- more -->

è¿™é‡Œæ˜¯[æºç ](https://github.com/HenryTSZ/vuepress-element-extend/blob/master/docs/.vuepress/components/TextEllipsis.vue)

è¿™é‡Œæˆ‘ä»¬ä¸»è¦ä½¿ç”¨ `el-tooltip` è¿™ä¸ªç»„ä»¶æ¥å®ç°è¿™ä¸ªåŠŸèƒ½

## å°è£…æ€è·¯:

1. é€šè¿‡ `content` ä¼ å…¥æ–‡æœ¬
2. é€šè¿‡ `css` å®ç°æº¢å‡ºæ˜¾ç¤ºçœç•¥å·çš„æ ·å¼
3. é¼ æ ‡æ‚¬æµ®å, åˆ¤æ–­ `scrollWidth` æ˜¯å¦è¶…è¿‡ `offsetWidth`, å¦‚æœè¶…è¿‡, æ˜¾ç¤º `tooltip`, å¦åˆ™è®¾ç½® `disabled`

ç”±äºæ¯”è¾ƒç®€å•, ç›´æ¥ä¸Šä»£ç äº†:

## ä»£ç 

```html
<template>
  <el-tooltip class="text-ellipsis" v-bind="$attrs" :disabled="disabled" :content="content">
    <div @mouseenter.stop="handleMouseEnter">
      {{ content }}
    </div>
  </el-tooltip>
</template>

<script>
  export default {
    name: 'TextEllipsis',
    props: {
      content: {
        type: String,
        default: ''
      }
    },
    data() {
      return {
        disabled: true
      }
    },
    methods: {
      handleMouseEnter(e) {
        const { scrollWidth, offsetWidth } = e.target
        this.disabled = scrollWidth <= offsetWidth
      }
    }
  }
</script>

<style lang="less" scoped>
  .text-ellipsis {
    width: 100%;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
</style>
```

## æ‰©å±• - å¤šè¡Œ

æœ€è¿‘é‡åˆ°éœ€è¦å¤šè¡Œæº¢å‡ºæ˜¾ç¤ºçœç•¥å·çš„éœ€æ±‚, è€Œå’±ä»¬è¿™ä¸ªåªæ”¯æŒå•è¡Œ, æ‰€ä»¥éœ€è¦æ‰©å±•ä¸€ä¸‹

`css` æ ·å¼æ¯”è¾ƒå¥½æå®š:

```css
.text-ellipsis {
  width: 100%;
  overflow: hidden;
  display: -webkit-box;
  text-overflow: ellipsis;
  -webkit-box-orient: vertical;
}
```

`-webkit-line-clamp` è¿™ä¸ªå±æ€§éœ€è¦é€šè¿‡ `props` æ¥æ”¶å¹¶åœ¨ `div` ä¸­è®¾ç½®:

```html
<div :style="{ '-webkit-line-clamp': lineClamp }" @mouseenter.stop="handleMouseEnter">
  {{ content }}
</div>
```

è€Œ `js` å°±æ¯”è¾ƒéº»çƒ¦äº†, åœ¨ç¾¤é‡Œé—®äº†å¤§ä½¬ä¸€ä¸‹, è²Œä¼¼æ²¡æœ‰å“ªä¸ªæ–¹æ³•å¯ä»¥è·å–æ˜¯å¦å‡ºç°çœç•¥å·, éƒ½éœ€è¦è‡ªå·±è®¡ç®—æ¥è·å–

è€Œä¸”éƒ½æ¯”è¾ƒéº»çƒ¦, éœ€è¦åˆ¤æ–­ `padding` `border` ç­‰å°ºå¯¸, è€Œå’±ä»¬ä¸€èˆ¬ä½¿ç”¨æ¯”è¾ƒç®€å•, æ²¡é‚£ä¹ˆå¤æ‚, æ‰€ä»¥å°±å‚ç…§ä»¥å‰çš„æ”¹æ”¹å§

æ­¤æ—¶å°±éœ€è¦ç”¨ `height` æ¥ä»£æ›¿ `width` è®¡ç®—æ˜¯å¦å‡ºç°çœç•¥å·:

```js
handleMouseEnter({ target }) {
  const { scrollHeight, offsetHeight } = target
  this.disabled = scrollHeight <= offsetHeight
}
```

æœ¬æ¥æµ‹è¯•çš„æ˜¯æ²¡é—®é¢˜çš„, æ²¡æƒ³åˆ°é¡¹ç›®å®é™…ä¸­ç«Ÿç„¶å‡ºç° `scrollHeight` æ¯” `offsetHeight` å¤š `1px` çš„æƒ…å†µ, å¯¼è‡´æ˜æ˜æ²¡æœ‰å‡ºç°çœç•¥å·, é¼ æ ‡æ‚¬æµ®ä¸Šå»çš„æ—¶å€™ä¼šæ˜¾ç¤º `tooltip`

ç»è¿‡ä¸€ç•ªç ”ç©¶åå‘ç°å¦‚æœå‡ºç°çœç•¥å·, é‚£ä¹ˆ `scrollHeight` çš„é«˜åº¦è‡³å°‘æ¯” `offsetHeight` é«˜ä¸€è¡Œ, é‚£ä¹ˆèƒ½ä¸èƒ½æŒ‰ç…§è¿™ä¸ªé€»è¾‘æ¥è®¡ç®—å‘¢?

```js
handleMouseEnter({ target }) {
  const { scrollHeight, offsetHeight } = target
  // è¿™é‡Œä¸èƒ½å†ç”¨ <=
  this.disabled = scrollHeight - offsetHeight < offsetHeight / this.lineClamp
}
```

å†æ¬¡æµ‹è¯•å, å‘ç°å¦‚æœå¢åŠ  `border`, `scrollHeight` çš„é«˜åº¦æ¯” `offsetHeight` é«˜ä¸€è¡Œæ—¶, è®¡ç®—ä»æœ‰è¯¯, è¿™æ˜¯å› ä¸º `offsetHeight` æœ‰ `border` çš„å®½åº¦, è€Œ `scrollHeight` å¹¶æ²¡æœ‰, æ‰€ä»¥è¿˜æ˜¯ç”¨ `clientHeight` å§

```js
handleMouseEnter({ target }) {
  const { scrollHeight, clientHeight } = target
  // è¿™é‡Œä¸èƒ½å†ç”¨ <=
  this.disabled = scrollHeight - clientHeight < clientHeight / this.lineClamp
}
```

## é—®é¢˜

### padding ä¼šæœ‰å½±å“

![padding](/img/element-ui/018.png)

å¦‚å›¾æ‰€ç¤º, è¿™é‡Œè®¾ç½® `padding: 50px`, å¯ä»¥çœ‹åˆ°è™½ç„¶å‡ºç°äº†çœç•¥å·, ä½†ç¬¬å››è¡Œå¹¶æ²¡æœ‰è¢«éšè—, è€Œä¸”è®¡ç®—åˆæœ‰è¯¯äº†, åªæœ‰å½“å‡ºç°ç¬¬äº”è¡Œçš„æ—¶å€™, è®¡ç®—æ‰æ­£ç¡®

è¿™ä¸ª `bug` ç›®å‰å°±ä¸æ‰“ç®—è§£å†³äº†, æ¯•ç«Ÿ `chrome` è¿˜æ²¡æœ‰è§£å†³å‘¢! ğŸ¶

å…¶å®è¿™ä¸ªè¯´éš¾å¾ˆéš¾, è¯´ç®€å•ä¹Ÿç®€å•!

åœ¨å¤–é¢åŒ…è£¹ä¸€å±‚ä¸å°±å¯ä»¥äº†å—? å¤–å±‚æ§åˆ¶ä½ç½®ç­‰æ ·å¼, å†…å±‚æ§åˆ¶å¤šè¡Œçœç•¥å·å³å¯

```html
<el-tooltip
  class="text-ellipsis"
  v-bind="$attrs"
  :disabled="disabled"
  :content="content"
  :open-delay="openDelay"
>
  <div>
    <div
      class="text-ellipsis-content"
      :style="{ '-webkit-line-clamp': lineClamp }"
      @mouseenter.stop="handleMouseEnter"
    >
      {{ content }}
    </div>
  </div>
</el-tooltip>
```

```less
.text-ellipsis {
  width: 100%;
  &-content {
    display: -webkit-box;
    width: 100%;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: normal; // ä½¿ç”¨é»˜è®¤å€¼, é˜²æ­¢ç»§æ‰¿å±æ€§çš„æ—¶å€™é«˜åº¦è®¡ç®—æœ‰è¯¯
    -webkit-box-orient: vertical;
  }
}
```
