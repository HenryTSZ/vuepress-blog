---
title: Mac ä½¿ç”¨ VS Code é…åˆ Remote Development æ’ä»¶è¿æ¥ Windows è¿œç¨‹æœåŠ¡å™¨
date: 2020-10-11 00:00:00
categories:
  - Software
tags:
  - Vscode
  - Remote
thumbnail: /img/vscode/thumbnail.png
permalink: /pages/94a7fe/
---

é²è¿…æ›¾ç»è¯´è¿‡:

> å‰ç«¯å¼€å‘, å¿…å¤‡ä¸¤å°æ˜¾ç¤ºå™¨: ä¸€å° Code, å¦ä¸€å° View

<!-- more -->

## ç°çŠ¶

å¤§ä½¬è¯´è¿‡çš„è¯, å’±è‚¯å®šè¦ç…§åšå‘€(é²è¿…: æˆ‘å¯æ²¡è¯´è¿‡!). ä»¥å‰ç¡®å®æ˜¯è¿™æ ·çš„: `Mac` ç”µè„‘ç¼–å†™ä»£ç å¹¶èµ·æœåŠ¡, `Windows` é€šè¿‡ `ip` è®¿é—®æœåŠ¡æ¥æµè§ˆæ•ˆæœ, å¼€å‘ä½“éªŒæ æ çš„

å¥ˆä½•å¤©ä¸é‚äººæ„¿, æœ€è¿‘å…¬å¸æ•´æ”¹ `Wi-Fi` , ç¡¬ç”Ÿç”ŸæŠŠä¸Šä¼ é€Ÿåº¦ä» `10Mb/s` é™åˆ¶åˆ° `500kb/s` , è¿™ä¸€ä¸‹å¯è‹¦äº†, åˆ·æ–°ä¸€ä¸‹é¡µé¢è¦ç­‰ä¸€åˆ†å¤šé’Ÿæ‰èƒ½åŠ è½½å®Œæˆ, è¿™æ•´å¤©å•¥ä¹Ÿä¸ç”¨å¹²äº†, å°±ç­‰åˆ·æ–°æ—¶é—´äº†

æ— å¥ˆåªèƒ½é—®é—® `IT` åŒäº‹çœ‹çœ‹æœ‰æ²¡æœ‰åŠæ³•è§£å†³, æ¯•ç«Ÿè¿™åªæ˜¯å†…ç½‘äº’ä¼ å‘€, ä½ è¯´è®¿é—®å…¬ç½‘ä¸Šä¼ é™åˆ¶å°±é™åˆ¶ä¸€ä¸‹å§, å†…ç½‘è¿˜é™åˆ¶å•¥å‘€. æœ€åå¾—åˆ°çš„ç»“è®ºå°±æ˜¯:

> ä¸è¦ç”¨ `Wi-Fi` , ä½¿ç”¨ç½‘çº¿

å¥½å§, çœ‹æ¥ `Wi-Fi` ä»¥åæ˜¯ä¸èƒ½ç”¨äº†, ä¸Šäº¬ä¸œçœ‹çœ‹æ‰©å±•åå§, å¥½å®¶ä¼™, éƒ½å¾—ä¸€ç™¾å¤š, è¿™ä¹ˆä¸€æƒ³, åˆ·æ–°åç­‰ä¸€åˆ†é’Ÿä¹Ÿæ˜¯å¯ä»¥æ¥å—çš„å˜›(ğŸ¶)

éš¾é“å°±æ²¡æœ‰åˆ«çš„åŠæ³•äº†å—?

åŠæ³•è‚¯å®šæ˜¯æœ‰çš„å•¦, é‚£å°±æ˜¯ä½¿ç”¨ `VS Code` çš„è¿œç¨‹å¼€å‘åŠŸèƒ½; åˆçœäº†ä¸€ç™¾å¤§æ´‹, ç¦»ä¹°æˆ¿è®¡åˆ’åˆè¿›äº†ä¸€æ­¥(ğŸ˜Š)

## ä»‹ç»

å¾®è½¯åœ¨ `PyCon 2019` å¤§ä¼šä¸Šå‘å¸ƒäº† `VS Code Remote` , ä» `1.35.0` ç‰ˆæœ¬æ­£å¼æä¾›å¯ä»¥åœ¨æœ¬åœ°ç¼–è¾‘è¿œç¨‹å¼€å‘ç¯å¢ƒçš„æ–‡ä»¶çš„åŠŸèƒ½, æ‰€ä»¥é¦–å…ˆç¡®ä¿ä½ çš„ `VS Code` ç‰ˆæœ¬æ˜¯åœ¨è¿™ä¸ªä¹‹ä¸Šçš„æ‰èƒ½ä½“éªŒåˆ°.

`VS Code` è¿œç¨‹å¼€å‘çš„å·¥ä½œåŸç†, å¤§è‡´æ˜¯è¿™æ ·çš„:

![architecture](/img/vscode/023.png)

å®˜æ–¹æ–‡æ¡£: [Visual Studio Code Remote Development](https://code.visualstudio.com/docs/remote/remote-overview)

## Windows å‡†å¤‡å·¥ä½œ (Win 10)

### å®‰è£… OpenSSH

ä»å¼€å§‹èœå•æ‰“å¼€ `è®¾ç½®` , ç„¶åé€‰æ‹© `åº”ç”¨å’ŒåŠŸèƒ½` , è¿™é‡Œå°±æœ‰ä¸€ä¸ª `ç®¡ç†å¯é€‰åŠŸèƒ½` çš„é€‰é¡¹.

![application and function](/img/vscode/029.png)

ç‚¹å‡»ä¹‹åä¾¿å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¯é€‰åŠŸèƒ½, é€‰æ‹© `OpenSSH` æœåŠ¡å™¨å³å¯, ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯æ²¡æœ‰å®‰è£…çš„. å¦‚æœæ²¡æœ‰å®‰è£…çš„è¯å®ƒä¼šæç¤ºä¸€ä¸ªå®‰è£…æŒ‰é’®, è¿™é‡Œæˆ‘å·²ç»å®‰è£…å¥½äº†, å°±æç¤ºäº†ä¸€ä¸ªå¸è½½æŒ‰é’®.

![OpenSSH](/img/vscode/030.png)

OK, æœ‰äº†å®ƒ, ç›´æ¥ç‚¹å‡»å®‰è£…å³å¯å®Œæˆ `OpenSSH` æœåŠ¡å™¨çš„å®‰è£….

å½“ç„¶å¦‚æœä½ æ˜¯æƒ³æ‰¹é‡éƒ¨ç½² `Windows` æœåŠ¡å™¨çš„è¯, å½“ç„¶æ˜¯æ¨èä½¿ç”¨ `PowerShell` æ¥è‡ªåŠ¨åŒ–éƒ¨ç½²äº†.

é¦–å…ˆéœ€è¦ç”¨ç®¡ç†å‘˜èº«ä»½å¯åŠ¨ `PowerShell` (åœ¨å¼€å§‹èœå•å³é”®é€‰æ‹©)

![admin PowerShell](/img/vscode/031.png)

ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤çœ‹ä¸€ä¸‹, è¦ç¡®ä¿ `OpenSSH` å¯ç”¨äºå®‰è£…:

```BASH
Get-WindowsCapability -Online | ? Name -like 'OpenSSH*'
```

è¾“å‡ºåº”è¯¥æ˜¯ç±»ä¼¼çš„ç»“æœ:

```BASH
Name  : OpenSSH.Client~~~~0.0.1.0
State : NotPresent
Name  : OpenSSH.Server~~~~0.0.1.0
State : NotPresent
```

ä¸Šé¢è¾“å‡ºè¡¨ç¤º `OpenSSH` çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å‡ä¸å­˜åœ¨

æˆ‘ä»¬è¿™é‡Œåªéœ€è¦æœåŠ¡ç«¯: å¦‚æœ `Server` çš„çŠ¶æ€ä¸º `Installed`, å°±è¡¨ç¤ºå·²ç»å®‰è£…å®Œæˆ

è§‚çœ‹ä¸‹é¢çš„[é…ç½® OpenSSH](/pages/94a7fe/#é…ç½®-openssh) å³å¯

å¦‚æœçŠ¶æ€ä¸º `NotPresent` å°±éœ€è¦æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æ¥å®‰è£…äº†

ç„¶åä½¿ç”¨ `PowerShell` å®‰è£…æœåŠ¡å™¨å³å¯:

```BASH
Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0
```

è¾“å‡ºç»“æœç±»ä¼¼:

```BASH
Path          :
Online        : True
RestartNeeded : False
```

è¿™æ ·ä¹Ÿå¯ä»¥å®Œæˆ `OpenSSH` çš„å®‰è£….

### é…ç½® OpenSSH

å®‰è£…å®Œæˆä¹‹å, å°±éœ€è¦è¿›è¡Œä¸€äº›åˆå§‹åŒ–é…ç½®äº†, è¿˜æ˜¯ä»¥ç®¡ç†å‘˜èº«ä»½, ä½¿ç”¨ `PowerShell` æ‰§è¡Œå³å¯.

é¦–å…ˆéœ€è¦å¼€å¯ `SSHD` æœåŠ¡:

```BASH
Start-Service sshd
```

ç„¶åè®¾ç½®æœåŠ¡çš„è‡ªåŠ¨å¯åŠ¨:

```BASH
Set-Service -Name sshd -StartupType 'Automatic'
```

æœ€åç¡®è®¤ä¸€ä¸‹é˜²ç«å¢™æ˜¯å¦æ˜¯æ”¾å¼€çš„:

```BASH
Get-NetFirewallRule -Name *ssh*
```

å¦‚æœæ˜¯æ”¾å¼€çš„, é‚£ä¹ˆç»“æœä¼šæç¤º `OpenSSH-Server-In-TCP` è¿™ä¸ªçŠ¶æ€æ˜¯ `enabled` .

å¥½äº†, å®Œæˆå¦‚ä¸Šæ“ä½œä¹‹åæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ `SSH` æ¥è¿æ¥æˆ‘ä»¬çš„ `Windows` æœåŠ¡å™¨äº†.

## Mac å‡†å¤‡å·¥ä½œ

### å®‰è£… VS Code å¹¶ä¸‹è½½æ’ä»¶

é¦–å…ˆä½ éœ€è¦æœ‰ `VS Code` , æ²¡æœ‰çš„è¯å°½å¿«å»å®˜ç½‘ä¸‹è½½. è¿™é‡Œæœ‰ä¸€ä»½å®Œæ•´é…ç½®, è¯·æŸ¥æ”¶: [VSCode å®Œæ•´ç‰ˆé…ç½® | Henry](/pages/6f52fa/)

ä¸‹è½½è¿œç¨‹æ’ä»¶: [Remote - SSH - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-ssh), [è½»è½»ç‚¹æˆ‘å®‰è£…](vscode:extension/ms-vscode-remote.remote-ssh)

å®‰è£…ååœ¨ä¾§è¾¹æ å’Œå·¦ä¸‹è§’å‡æœ‰æ˜¾ç¤º

![installed](/img/vscode/024.png)

### é…ç½®è¿œç¨‹è¿æ¥

é¦–å…ˆç‚¹ä¾§è¾¹æ çš„ã€Œè¿œç¨‹èµ„æºç®¡ç†å™¨ã€ä¹‹åç‚¹å‡»ã€Œè®¾ç½®æŒ‰é’®ã€, è¿›å…¥è¿œç¨‹æœºå™¨(ä»£æŒ‡ `Windows` , ä¸‹åŒ)é…ç½®ç•Œé¢.

![settings](/img/vscode/025.png)

ä¿®æ”¹ `ssh` é…ç½®æ–‡ä»¶, ç”¨äºç™»å½•è¿œç¨‹æœºå™¨, å„é¡¹å«ä¹‰åœ¨å›¾ä¸­æœ‰è¯´æ˜.

![config](/img/vscode/026.png)

![set config](/img/vscode/027.png)

ç‚¹å‡»è¿æ¥, ç™»å½•è¿œç¨‹æœåŠ¡å™¨, éœ€è¦è¾“å…¥è¿œç¨‹æœåŠ¡å™¨çš„å¯†ç (åé¢ä¼šæ•™ä½ æ€ä¹ˆå…å¯†ç™»å½•), è¾“å…¥ç¡®è®¤å³å¯. ç¬¬ä¸€æ¬¡è¿æ¥ä¼šåš `VS Code Server` çš„åˆå§‹åŒ–å·¥ä½œæ¯”è¾ƒæ…¢, è€å¿ƒç­‰å¾….

![connect](/img/vscode/028.png)

ç™»å½•æˆåŠŸ, å³å¯åƒæ“ä½œæœ¬åœ°ç¯å¢ƒä¸€æ ·, åœ¨ `VS Code` å®¢æˆ·ç«¯æ“ä½œè¿œç¨‹äº‘ä¸»æœºä¸Šçš„æ–‡ä»¶. æ³¨æ„, æ­¤æ—¶ã€Œæ‰“å¼€æ–‡ä»¶å¤¹ã€å·²ç»æ˜¯è¿œç«¯æœºå™¨ä¸Šçš„ç›®å½•ç»“æ„äº†.

å®‰è£…çš„æ’ä»¶æ˜¯åœ¨äº‘æœåŠ¡å™¨çš„ `VS Code` ä¸Š, å¯¹æœ¬æœºçš„ `VS Code` æ²¡æœ‰å½±å“, æ’ä»¶åœ¨è¿œç«¯æä¾›åŠŸèƒ½, æ¯”å¦‚ä»£ç å®¡æŸ¥ã€è‡ªåŠ¨è¡¥é½ç­‰ç­‰, è€Œè¿™æ‰€æœ‰çš„ä¸€åˆ‡å°±åƒåœ¨æœ¬åœ°æ“ä½œä¸€æ ·, å¯¹æ–‡ä»¶çš„æ›´æ”¹ä¹Ÿæ˜¯ç›´æ¥æ“ä½œçš„äº‘ä¸»æœºä¸Šçš„æ–‡ä»¶, ä¸æ»‘è¿æ¥.

![extension](/img/vscode/032.png)

## é…ç½® SSH å…å¯†ç™»å½•

æŒ‰ç…§ä¸Šé¢çš„é…ç½®æ­¥éª¤, æ¯æ¬¡è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨, éƒ½éœ€è¦è¾“å…¥æœåŠ¡å™¨ç™»å½•å¯†ç å¾ˆéº»çƒ¦, å¯ä»¥é…ç½® `SSH` å…å¯†ç™»å½•, å…å»æ¯æ¬¡è¾“å…¥å¯†ç çš„çƒ¦æ¼, å…·ä½“æ“ä½œæ­¥éª¤å¦‚ä¸‹:

### Mac ç”Ÿæˆ ssh-key

åœ¨ç»ˆç«¯, è¾“å…¥ `ssh-keygen -t rsa` ç”Ÿæˆç§˜é’¥å¯¹. å…³äºè¿™ä¸ªå‘½ä»¤å¯ä»¥å‚è€ƒ: [å¦‚ä½•ç”Ÿæˆ SSH key åŠæŸ¥çœ‹ SSH key - Rh ä¹å°¾é±¼ - åšå®¢å›­](https://www.cnblogs.com/zheng577564429/p/8317524.html), [SSH key çš„ä»‹ç»ä¸åœ¨ Git ä¸­çš„ä½¿ç”¨ - ç®€ä¹¦](https://www.jianshu.com/p/1246cfdbe460), è¿™é‡Œä¸å¤šèµ˜è¿°

æ‰“å¼€ç”Ÿæˆçš„ç§˜é’¥ä¿å­˜è·¯å¾„: `cd ~/.ssh/` , æ‹·è´ `id_rsa.pub` æ–‡ä»¶ä¸­çš„å†…å®¹ä»¥å¤‡åé¢ä½¿ç”¨

### Windows æ¥æ”¶ ssh-key

æ‰“å¼€ç§˜é’¥ä¿å­˜è·¯å¾„: `cd ~/.ssh/` , å¦‚æœæ²¡æœ‰çš„è¯ä¹Ÿç”Ÿæˆä¸€ä¸‹, ä¸è¿‡è¿™ä¸ªç§˜é’¥ç”¨ä¸åˆ°, åªæ˜¯éœ€è¦è¿™ä¸ªè·¯å¾„.

æ–°å»ºæ–‡ä»¶: `authorized_keys` , å°†ä» `Mac` æ‹·è´çš„ `id_rsa.pub` ä¸­çš„å†…å®¹å¤åˆ¶åˆ°è¯¥æ–‡ä»¶ä¸­

å†æ¬¡å°è¯•è¿œç¨‹è¿æ¥, å¦‚æœå®ç°å…å¯†ç™»é™†, é‚£ä¹ˆå°±ä¸ç”¨å¾€ä¸‹çœ‹äº†, å®‰å¿ƒäº«å—ä¸æ»‘èˆ¬çš„ç¼–ç ä½“éªŒå§

å¦‚æœè¿˜æ˜¯éœ€è¦å¯†ç , é‚£ä¹ˆæ¥ç€å¾€ä¸‹çœ‹

è¿˜æ˜¯ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ `PowerShell` æ‰“å¼€ `OpenSSH` é…ç½®æ–‡ä»¶

```BASH
cd C:\ProgramData\ssh\

vim sshd_config
```

æ³¨é‡Šç›¸å…³è¡Œ:

```BASH
#Match Group administrators
# AuthorizedKeysFile __PROGRAMDATA__/ssh/administrators_authorized_keys
```

å…è®¸ä½¿ç”¨ `sshd_config` æ–‡ä»¶ä¸­çš„ `RSA` å¯†é’¥è®¿é—® `Windows` :

```BASH
PubkeyAuthentication yes
```

å¹¶ç¦ç”¨ `ssh` å¯†ç ç™»å½•:

```BASH
PasswordAuthentication no
```

å°†æ›´æ”¹ä¿å­˜åˆ° `sshd_config` å, ä¸è¦å¿˜è®°é‡æ–°å¯åŠ¨ `sshd` æœåŠ¡.

```BASH
restart-service sshd
```

å¥½äº†, è¿™æ¬¡å¯ä»¥å…å¯†ç™»é™†å•¦

## é—®é¢˜

### é•¿æ—¶é—´ä¸æ“ä½œå°±æ–­å¼€è¿æ¥

åœ¨è¿æ¥è¿œç¨‹æœåŠ¡å™¨çš„æ—¶å€™å‡ºç°ä¸€æ®µæ—¶é—´ä¸æ“ä½œè¿æ¥æ–­å¼€çš„è§£å†³æ–¹æ³•:

æ‰¾åˆ° `sshd_config` é…ç½®æ–‡ä»¶è¿›è¡Œç¼–è¾‘:

```BASH
sudo vim /etc/ssh/sshd_config
```

åœ¨å…¶ä¸­æ‰¾åˆ°ä»¥ä¸‹é…ç½®é¡¹ç›®:

```BASH
#ClientAliveInterval 0
#ClientAliveCountMax 3
```

å»é™¤æ³¨é‡Šå¹¶ä¿®æ”¹

```BASH
ClientAliveInterval 60
ClientAliveCountMax 3
```

`ClientAliveInterval` æŒ‡å®šäº†æœåŠ¡å™¨ç«¯å‘å®¢æˆ·ç«¯è¯·æ±‚æ¶ˆæ¯çš„æ—¶é—´é—´éš”, é»˜è®¤æ˜¯ `0` , ä¸å‘é€. è€Œ `ClientAliveInterval 60` è¡¨ç¤ºæ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡, ç„¶åå®¢æˆ·ç«¯å“åº”, è¿™æ ·å°±ä¿æŒé•¿è¿æ¥äº†.

`ClientAliveCountMax` , ä½¿ç”¨é»˜è®¤å€¼ `3` å³å¯. `ClientAliveCountMax` è¡¨ç¤ºæœåŠ¡å™¨å‘å‡ºè¯·æ±‚åå®¢æˆ·ç«¯æ²¡æœ‰å“åº”çš„æ¬¡æ•°è¾¾åˆ°ä¸€å®šå€¼, å°±è‡ªåŠ¨æ–­å¼€. æ­£å¸¸æƒ…å†µä¸‹, å®¢æˆ·ç«¯ä¸ä¼šä¸å“åº”.

é‡å¯ `sshd service`

```BASH
sudo launchctl unload /System/Library/LaunchDaemons/ssh.plist
sudo launchctl load -w /System/Library/LaunchDaemons/ssh.plist
```

æˆ–è€…

```bash
sudo launchctl stop com.openssh.sshd
sudo launchctl start com.openssh.sshd
```

## å‚è€ƒèµ„æ–™

- [å¦‚ä½•ä½¿ç”¨ SSH æ§åˆ¶è¿æ¥ Windows æœåŠ¡å™¨ | é™è§…](https://cuiqingcai.com/6509.html)
- [æ‰‹æŠŠæ‰‹æ•™ä½ é…ç½® VS Code è¿œç¨‹å¼€å‘å·¥å…·, å·¥ä½œæ•ˆç‡æå‡ N å€ - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/141344165)
- [Configuring SSH Key-Based Authentication on Windows 10/ Server 2019 | Windows OS Hub](http://woshub.com/using-ssh-key-based-authentication-on-windows/)
- [ä½¿ç”¨ VS Code é…åˆ Remote Development æ’ä»¶è¿æ¥è¿œç¨‹æœåŠ¡å™¨(Mac/Linux+Windows) | Using VS Code with Remote Development Connect to Remote Server (Mac/Linux+Windows) - å¤©é–å±…å£« - åšå®¢å›­](https://www.cnblogs.com/kkyyhh96/p/11026814.html)
- [Connecting to GitHub with SSH - GitHub Docs](https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/connecting-to-github-with-ssh)
- [SSH key çš„ä»‹ç»ä¸åœ¨ Git ä¸­çš„ä½¿ç”¨ - ç®€ä¹¦](https://www.jianshu.com/p/1246cfdbe460)
- [å¦‚ä½•ç”Ÿæˆ SSH key åŠæŸ¥çœ‹ SSH key - Rh ä¹å°¾é±¼ - åšå®¢å›­](https://www.cnblogs.com/zheng577564429/p/8317524.html)
- [ä½¿ç”¨ VS Code é…åˆ Remote Development æ’ä»¶è¿æ¥è¿œç¨‹æœåŠ¡å™¨(Mac/Linux+Windows) | Using VS Code with Remote Development Connect to Remote Server (Mac/Linux+Windows) - å¤©é–å±…å£« - åšå®¢å›­](https://www.cnblogs.com/kkyyhh96/p/11026814.html)
- [windows ä¸Šå®‰è£… openSSH æœåŠ¡\_æ…§å†™ä»£ç -CSDN åšå®¢](https://blog.csdn.net/hehuihh/article/details/90575791)
- [windows ä¸‹ä½¿ç”¨ vscode è¿œç¨‹è¿æ¥ Linux æœåŠ¡å™¨è¿›è¡Œå¼€å‘ - ç®€ä¹¦](https://www.jianshu.com/p/df7b2842d105)
- [How To Restart SSH Service under Linux / UNIX - nixCraft](https://www.cyberciti.biz/faq/howto-restart-ssh/)
